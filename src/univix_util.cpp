#include "univix_util.h"

#if (defined(__AVR_ATmega328P__))
const PROGMEM uint8_t util::bit_count[256] = {0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8};
const PROGMEM uint8_t util::bit_count2x[256] = {0, 2, 2, 4, 2, 4, 4, 6, 2, 4, 4, 6, 4, 6, 6, 8, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 8, 10, 10, 12, 10, 12, 12, 14, 10, 12, 12, 14, 12, 14, 14, 16};
const PROGMEM uint8_t util::bit_count_lf_ch[256] = {0, 2, 1, 3, 2, 4, 3, 5, 1, 3, 2, 4, 3, 5, 4, 6, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 1, 3, 2, 4, 3, 5, 4, 6, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 6, 8, 7, 9, 8, 10, 9, 11, 1, 3, 2, 4, 3, 5, 4, 6, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 6, 8, 7, 9, 8, 10, 9, 11, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 6, 8, 7, 9, 8, 10, 9, 11, 7, 9, 8, 10, 9, 11, 10, 12};
const PROGMEM uint32_t util::mask32[32] = {2147483648UL, 1073741824UL, 536870912UL, 268435456UL, 134217728UL, 67108864UL, 33554432UL, 16777216UL, 8388608UL, 4194304UL, 2097152UL, 1048576UL, 524288UL, 262144UL, 131072UL, 65536UL, 32768UL, 16384UL, 8192UL, 4096UL, 2048UL, 1024UL, 512UL, 256UL, 128UL, 64UL, 32UL, 16UL, 8UL, 4UL, 2UL, 1UL};
const PROGMEM uint32_t util::ryte_mask32[32] = {4294967295UL, 2147483647UL, 1073741823UL, 536870911UL, 268435455UL, 134217727UL, 67108863UL, 33554431UL, 16777215UL, 8388607UL, 4194303UL, 2097151UL, 1048575UL, 524287UL, 262143UL, 131071UL, 65535UL, 32767UL, 16383UL, 8191UL, 4095UL, 2047UL, 1023UL, 511UL, 255UL, 127UL, 63UL, 31UL, 15UL, 7UL, 3UL, 1UL};
const PROGMEM uint32_t util::left_mask32[32] = {0UL, 2147483648UL, 3221225472UL, 3758096384UL, 4026531840UL, 4160749568UL, 4227858432UL, 4261412864UL, 4278190080UL, 4286578688UL, 4290772992UL, 4292870144UL, 4293918720UL, 4294443008UL, 4294705152UL, 4294836224UL, 4294901760UL, 4294934528UL, 4294950912UL, 4294959104UL, 4294963200UL, 4294965248UL, 4294966272UL, 4294966784UL, 4294967040UL, 4294967168UL, 4294967232UL, 4294967264UL, 4294967280UL, 4294967288UL, 4294967292UL, 4294967294UL};
const PROGMEM uint64_t util::mask64[64] = {9223372036854775808UL, 4611686018427387904UL, 2305843009213693952UL, 1152921504606846976UL, 576460752303423488UL, 288230376151711744UL, 144115188075855872UL, 72057594037927936UL, 36028797018963968UL, 18014398509481984UL, 9007199254740992UL, 4503599627370496UL, 2251799813685248UL, 1125899906842624UL, 562949953421312UL, 281474976710656UL, 140737488355328UL, 70368744177664UL, 35184372088832UL, 17592186044416UL, 8796093022208UL, 4398046511104UL, 2199023255552UL, 1099511627776UL, 549755813888UL, 274877906944UL, 137438953472UL, 68719476736UL, 34359738368UL, 17179869184UL, 8589934592UL, 4294967296UL, 2147483648UL, 1073741824UL, 536870912UL, 268435456UL, 134217728UL, 67108864UL, 33554432UL, 16777216UL, 8388608UL, 4194304UL, 2097152UL, 1048576UL, 524288UL, 262144UL, 131072UL, 65536UL, 32768UL, 16384UL, 8192UL, 4096UL, 2048UL, 1024UL, 512UL, 256UL, 128UL, 64UL, 32UL, 16UL, 8UL, 4UL, 2UL, 1UL};
const PROGMEM uint64_t util::ryte_mask64[64] = {18446744073709551615UL, 9223372036854775807UL, 4611686018427387903UL, 2305843009213693951UL, 1152921504606846975UL, 576460752303423487UL, 288230376151711743UL, 144115188075855871UL, 72057594037927935UL, 36028797018963967UL, 18014398509481983UL, 9007199254740991UL, 4503599627370495UL, 2251799813685247UL, 1125899906842623UL, 562949953421311UL, 281474976710655UL, 140737488355327UL, 70368744177663UL, 35184372088831UL, 17592186044415UL, 8796093022207UL, 4398046511103UL, 2199023255551UL, 1099511627775UL, 549755813887UL, 274877906943UL, 137438953471UL, 68719476735UL, 34359738367UL, 17179869183UL, 8589934591UL, 4294967295UL, 2147483647UL, 1073741823UL, 536870911UL, 268435455UL, 134217727UL, 67108863UL, 33554431UL, 16777215UL, 8388607UL, 4194303UL, 2097151UL, 1048575UL, 524287UL, 262143UL, 131071UL, 65535UL, 32767UL, 16383UL, 8191UL, 4095UL, 2047UL, 1023UL, 511UL, 255UL, 127UL, 63UL, 31UL, 15UL, 7UL, 3UL, 1UL};
const PROGMEM uint64_t util::left_mask64[64] = {0UL, 9223372036854775808UL, 13835058055282163712UL, 16140901064495857664UL, 17293822569102704640UL, 17870283321406128128UL, 18158513697557839872UL, 18302628885633695744UL, 18374686479671623680UL, 18410715276690587648UL, 18428729675200069632UL, 18437736874454810624UL, 18442240474082181120UL, 18444492273895866368UL, 18445618173802708992UL, 18446181123756130304UL, 18446462598732840960UL, 18446603336221196288UL, 18446673704965373952UL, 18446708889337462784UL, 18446726481523507200UL, 18446735277616529408UL, 18446739675663040512UL, 18446741874686296064UL, 18446742974197923840UL, 18446743523953737728UL, 18446743798831644672UL, 18446743936270598144UL, 18446744004990074880UL, 18446744039349813248UL, 18446744056529682432UL, 18446744065119617024UL, 18446744069414584320UL, 18446744071562067968UL, 18446744072635809792UL, 18446744073172680704UL, 18446744073441116160UL, 18446744073575333888UL, 18446744073642442752UL, 18446744073675997184UL, 18446744073692774400UL, 18446744073701163008UL, 18446744073705357312UL, 18446744073707454464UL, 18446744073708503040UL, 18446744073709027328UL, 18446744073709289472UL, 18446744073709420544UL, 18446744073709486080UL, 18446744073709518848UL, 18446744073709535232UL, 18446744073709543424UL, 18446744073709547520UL, 18446744073709549568UL, 18446744073709550592UL, 18446744073709551104UL, 18446744073709551360UL, 18446744073709551488UL, 18446744073709551552UL, 18446744073709551584UL, 18446744073709551600UL, 18446744073709551608UL, 18446744073709551612UL, 18446744073709551614UL};
#else
const uint8_t util::bit_count[256] = {0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8};
const uint8_t util::bit_count2x[256] = {0, 2, 2, 4, 2, 4, 4, 6, 2, 4, 4, 6, 4, 6, 6, 8, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 2, 4, 4, 6, 4, 6, 6, 8, 4, 6, 6, 8, 6, 8, 8, 10, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 4, 6, 6, 8, 6, 8, 8, 10, 6, 8, 8, 10, 8, 10, 10, 12, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 6, 8, 8, 10, 8, 10, 10, 12, 8, 10, 10, 12, 10, 12, 12, 14, 8, 10, 10, 12, 10, 12, 12, 14, 10, 12, 12, 14, 12, 14, 14, 16};
const uint8_t util::bit_count_lf_ch[256] = {0, 2, 1, 3, 2, 4, 3, 5, 1, 3, 2, 4, 3, 5, 4, 6, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 1, 3, 2, 4, 3, 5, 4, 6, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 6, 8, 7, 9, 8, 10, 9, 11, 1, 3, 2, 4, 3, 5, 4, 6, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 2, 4, 3, 5, 4, 6, 5, 7, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 3, 5, 4, 6, 5, 7, 6, 8, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 6, 8, 7, 9, 8, 10, 9, 11, 4, 6, 5, 7, 6, 8, 7, 9, 5, 7, 6, 8, 7, 9, 8, 10, 6, 8, 7, 9, 8, 10, 9, 11, 7, 9, 8, 10, 9, 11, 10, 12};
const uint32_t util::mask32[32] = {2147483648UL, 1073741824UL, 536870912UL, 268435456UL, 134217728UL, 67108864UL, 33554432UL, 16777216UL, 8388608UL, 4194304UL, 2097152UL, 1048576UL, 524288UL, 262144UL, 131072UL, 65536UL, 32768UL, 16384UL, 8192UL, 4096UL, 2048UL, 1024UL, 512UL, 256UL, 128UL, 64UL, 32UL, 16UL, 8UL, 4UL, 2UL, 1UL};
const uint32_t util::ryte_mask32[32] = {4294967295UL, 2147483647UL, 1073741823UL, 536870911UL, 268435455UL, 134217727UL, 67108863UL, 33554431UL, 16777215UL, 8388607UL, 4194303UL, 2097151UL, 1048575UL, 524287UL, 262143UL, 131071UL, 65535UL, 32767UL, 16383UL, 8191UL, 4095UL, 2047UL, 1023UL, 511UL, 255UL, 127UL, 63UL, 31UL, 15UL, 7UL, 3UL, 1UL};
const uint32_t util::left_mask32[32] = {0UL, 2147483648UL, 3221225472UL, 3758096384UL, 4026531840UL, 4160749568UL, 4227858432UL, 4261412864UL, 4278190080UL, 4286578688UL, 4290772992UL, 4292870144UL, 4293918720UL, 4294443008UL, 4294705152UL, 4294836224UL, 4294901760UL, 4294934528UL, 4294950912UL, 4294959104UL, 4294963200UL, 4294965248UL, 4294966272UL, 4294966784UL, 4294967040UL, 4294967168UL, 4294967232UL, 4294967264UL, 4294967280UL, 4294967288UL, 4294967292UL, 4294967294UL};
const uint64_t util::mask64[64] = {9223372036854775808UL, 4611686018427387904UL, 2305843009213693952UL, 1152921504606846976UL, 576460752303423488UL, 288230376151711744UL, 144115188075855872UL, 72057594037927936UL, 36028797018963968UL, 18014398509481984UL, 9007199254740992UL, 4503599627370496UL, 2251799813685248UL, 1125899906842624UL, 562949953421312UL, 281474976710656UL, 140737488355328UL, 70368744177664UL, 35184372088832UL, 17592186044416UL, 8796093022208UL, 4398046511104UL, 2199023255552UL, 1099511627776UL, 549755813888UL, 274877906944UL, 137438953472UL, 68719476736UL, 34359738368UL, 17179869184UL, 8589934592UL, 4294967296UL, 2147483648UL, 1073741824UL, 536870912UL, 268435456UL, 134217728UL, 67108864UL, 33554432UL, 16777216UL, 8388608UL, 4194304UL, 2097152UL, 1048576UL, 524288UL, 262144UL, 131072UL, 65536UL, 32768UL, 16384UL, 8192UL, 4096UL, 2048UL, 1024UL, 512UL, 256UL, 128UL, 64UL, 32UL, 16UL, 8UL, 4UL, 2UL, 1UL};
const uint64_t util::ryte_mask64[64] = {18446744073709551615UL, 9223372036854775807UL, 4611686018427387903UL, 2305843009213693951UL, 1152921504606846975UL, 576460752303423487UL, 288230376151711743UL, 144115188075855871UL, 72057594037927935UL, 36028797018963967UL, 18014398509481983UL, 9007199254740991UL, 4503599627370495UL, 2251799813685247UL, 1125899906842623UL, 562949953421311UL, 281474976710655UL, 140737488355327UL, 70368744177663UL, 35184372088831UL, 17592186044415UL, 8796093022207UL, 4398046511103UL, 2199023255551UL, 1099511627775UL, 549755813887UL, 274877906943UL, 137438953471UL, 68719476735UL, 34359738367UL, 17179869183UL, 8589934591UL, 4294967295UL, 2147483647UL, 1073741823UL, 536870911UL, 268435455UL, 134217727UL, 67108863UL, 33554431UL, 16777215UL, 8388607UL, 4194303UL, 2097151UL, 1048575UL, 524287UL, 262143UL, 131071UL, 65535UL, 32767UL, 16383UL, 8191UL, 4095UL, 2047UL, 1023UL, 511UL, 255UL, 127UL, 63UL, 31UL, 15UL, 7UL, 3UL, 1UL};
const uint64_t util::left_mask64[64] = {0UL, 9223372036854775808UL, 13835058055282163712UL, 16140901064495857664UL, 17293822569102704640UL, 17870283321406128128UL, 18158513697557839872UL, 18302628885633695744UL, 18374686479671623680UL, 18410715276690587648UL, 18428729675200069632UL, 18437736874454810624UL, 18442240474082181120UL, 18444492273895866368UL, 18445618173802708992UL, 18446181123756130304UL, 18446462598732840960UL, 18446603336221196288UL, 18446673704965373952UL, 18446708889337462784UL, 18446726481523507200UL, 18446735277616529408UL, 18446739675663040512UL, 18446741874686296064UL, 18446742974197923840UL, 18446743523953737728UL, 18446743798831644672UL, 18446743936270598144UL, 18446744004990074880UL, 18446744039349813248UL, 18446744056529682432UL, 18446744065119617024UL, 18446744069414584320UL, 18446744071562067968UL, 18446744072635809792UL, 18446744073172680704UL, 18446744073441116160UL, 18446744073575333888UL, 18446744073642442752UL, 18446744073675997184UL, 18446744073692774400UL, 18446744073701163008UL, 18446744073705357312UL, 18446744073707454464UL, 18446744073708503040UL, 18446744073709027328UL, 18446744073709289472UL, 18446744073709420544UL, 18446744073709486080UL, 18446744073709518848UL, 18446744073709535232UL, 18446744073709543424UL, 18446744073709547520UL, 18446744073709549568UL, 18446744073709550592UL, 18446744073709551104UL, 18446744073709551360UL, 18446744073709551488UL, 18446744073709551552UL, 18446744073709551584UL, 18446744073709551600UL, 18446744073709551608UL, 18446744073709551612UL, 18446744073709551614UL};
#endif
